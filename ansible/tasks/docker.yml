- name: Setting the correct permission for /etc/apt/keyrings # install -m 0755 -d /etc/apt/keyrings
  file:
    path: /etc/apt/keyrings
    state: directory
    mode: '0755'

- name: Add docker apt repository key
  ansible.builtin.get_url:
    url: https://download.docker.com/linux/{{ ansible_facts['distribution']|lower }}/gpg
    # {{ ansible_facts['distribution']|lower }} --> this get the information about the OS directly from the target and set it all to lower
    dest: /etc/apt/keyrings/docker.asc
    mode: '0644'
    force: true

- name: Update apt and install docker-ce
  apt:
    name: docker-ce
    state: latest
    update_cache: true

- name: Update apt and install docker various componets
  apt:
    name: "{{ dockeraddon }}"
    state: latest
    update_cache: true

- name: Create docker directory if it does not exist
  ansible.builtin.file:
    path: /srv/docker
    state: directory
    mode: '0755'
    owner: "{{ username }}"
